from functools import cache

chromatin_states = [
    "Active_TSS",
    "Flanking_Active_TSS",
    "Strong_transcription",
    "Weak_transcription",
    "Enhancers",
    "Genic_enhancers",
    "ZNF_genes_and_repeats",
    "Heterochromatin",
    "Bivalent_Poised_TSS",
    "Flanking_Bivalent_TSS_Enh",
    "Bivalent_Enhancer",
    "Repressed_PolyComb",
    "Weak_Repressed_PolyComb",
    "Transcr_at_gene_5_and_3",
    "Quiescent_Low",
]

cell_types = [
    "Adult_Liver",
    "H1_BMP4_Derived_Trophoblast_Cultured_Cells",
    "NHEK_Epidermal_Keratinocytes",
    "HSMMtube_Skeletal_Muscle_Myotubes_Derived_from_HSMM",
    "Monocytes_CD14pp_RO01746",
    "NHDF_Ad_Adult_Dermal_Fibroblasts",
    "Adipose_Nuclei",
    "Fetal_Kidney",
    "Fetal_Intestine_Small",
    "HMEC_Mammary_Epithelial",
    "Stomach_Mucosa",
    "hESC_Derived_CD184pp_Endoderm_Cultured_Cells",
    "Fetal_Brain_Male",
    "H1_Derived_Neuronal_Progenitor_Cultured_Cells",
    "Penis_Foreskin_Fibroblast_Primary_Cells_skin02",
    "Colonic_Mucosa",
    "Breast_vHMEC",
    "Skeletal_Muscle_Female",
    "HUES6_Cell_Line",
    "Chondrocytes_from_Bone_Marrow_Derived_Mesenchymal_Stem_Cell_Cultured_Cells",
    "Muscle_Satellite_Cultured_Cells",
    "Brain_Mid_Frontal_Lobe",
    "ES_I3_Cell_Line",
    "iPS_18_Cell_Line",
    "Penis_Foreskin_Keratinocyte_Primary_Cells_skin03",
    "NH_A_Astrocytes",
    "Pancreas",
    "HUES64_Cell_Line",
    "H1_Derived_Mesenchymal_Stem_Cells",
    "Breast_Myoepithelial_Cells",
    "CD4pp_CD25__IL17__PMA_Ionomycin_stimulated_MACS_purified_Th_Primary_Cells",
    "hESC_Derived_CD56pp_Ectoderm_Cultured_Cells",
    "Esophagus",
    "iPS_20b_Cell_Line",
    "Duodenum_Mucosa",
    "Rectal_Mucosa.Donor_31",
    "H9_Derived_Neuronal_Progenitor_Cultured_Cells",
    "Ovary",
    "IMR90_Cell_Line",
    "Dnd41_TCell_Leukemia",
    "Aorta",
    "Osteoblasts",
    "iPS_15b_Cell_Line",
    "CD34_Cultured_Cells",
    "iPS_DF_19.11_Cell_Line",
    "CD4pp_CD25pp_CD127__Treg_Primary_Cells",
    "Fetal_Adrenal_Gland",
    "HUVEC_Umbilical_Vein_Endothelial_Cells",
    "Fetal_Muscle_Trunk",
    "Colon_Smooth_Muscle",
    "CD4_Naive_Primary_Cells",
    "HUES48_Cell_Line",
    "Spleen",
    "HepG2_Hepatocellular_Carcinoma",
    "CD56_Primary_Cells",
    "CD3_Primary_Cells_Peripheral_UW",
    "CD4pp_CD25__CD45RApp_Naive_Primary_Cells",
    "CD34_Primary_Cells",
    "Sigmoid_Colon",
    "HeLa_S3_Cervical_Carcinoma",
    "Neurosphere_Cultured_Cells_Ganglionic_Eminence_Derived",
    "Mesenchymal_Stem_Cell_Derived_Adipocyte_Cultured_Cells",
    "Fetal_Intestine_Large",
    "Brain_Cingulate_Gyrus",
    "Penis_Foreskin_Fibroblast_Primary_Cells_skin01",
    "CD3_Primary_Cells_Cord_BI",
    "Penis_Foreskin_Melanocyte_Primary_Cells_skin01",
    "Brain_Anterior_Caudate",
    "Skeletal_Muscle_Male",
    "Fetal_Stomach",
    "CD4pp_CD25int_CD127pp_Tmem_Primary_Cells",
    "NHLF_Lung_Fibroblasts",
    "CD14_Primary_Cells",
    "Thymus",
    "Neurosphere_Cultured_Cells_Cortex_Derived",
    "Right_Ventricle",
    "Pancreatic_Islets",
    "Gastric",
    "GM12878_Lymphoblastoid",
    "Mobilized_CD34_Primary_Cells_Female",
    "CD4pp_CD25__IL17pp_PMA_Ionomcyin_stimulated_Th17_Primary_Cells",
    "Penis_Foreskin_Melanocyte_Primary_Cells_skin03",
    "Fetal_Placenta",
    "Fetal_Thymus",
    "H1_Cell_Line",
    "CD15_Primary_Cells",
    "Right_Atrium",
    "CD8_Memory_Primary_Cells",
    "hESC_Derived_CD56pp_Mesoderm_Cultured_Cells",
    "Fetal_Lung",
    "Bone_Marrow_Derived_Mesenchymal_Stem_Cell_Cultured_Cells",
    "Brain_Germinal_Matrix",
    "Small_Intestine",
    "H9_Cell_Line",
    "4star",
    "Brain_Substantia_Nigra",
    "iPS_DF_6.9_Cell_Line",
    "Brain_Inferior_Temporal_Lobe",
    "CD4pp_CD25__CD45ROpp_Memory_Primary_Cells",
    "CD4_Memory_Primary_Cells",
    "CD19_Primary_Cells_Peripheral_UW",
    "Peripheral_Blood_Mononuclear_Primary_Cells",
    "Rectal_Smooth_Muscle",
    "Left_Ventricle",
    "A549_EtOH_0.02pct_Lung_Carcinoma",
    "ES_WA7_Cell_Line",
    "Placenta_Amnion",
    "Adipose_Derived_Mesenchymal_Stem_Cell_Cultured_Cells",
    "Rectal_Mucosa.Donor_29",
    "Brain_Hippocampus_Middle",
    "Stomach_Smooth_Muscle",
    "CD4pp_CD25__Th_Primary_Cells",
    "Mobilized_CD34_Primary_Cells_Male",
    "CD8_Naive_Primary_Cells",
    "K562_Leukemia",
    "Fetal_Heart",
    "H9_Derived_Neuron_Cultured_Cells",
    "CD19_Primary_Cells_Cord_BI",
    "Fetal_Muscle_Leg",
    "Brain_Angular_Gyrus",
    "Fetal_Brain_Female",
    "Lung",
    "Duodenum_Smooth_Muscle",
    "HSMM_Skeletal_Muscle_Myoblasts",
    "Penis_Foreskin_Keratinocyte_Primary_Cells_skin02",
    "Psoas_Muscle",
    "H1_BMP4_Derived_Mesendoderm_Cultured_Cells",
]

cell_category = {
    "IPSC": {
        "iPS_18_Cell_Line",
        "iPS_20b_Cell_Line",
        "iPS_15b_Cell_Line",
        "iPS_DF_19.11_Cell_Line",
        "iPS_DF_6.9_Cell_Line",
    },
    "ESC": {
        "HUES6_Cell_Line",
        "ES_I3_Cell_Line",
        "HUES64_Cell_Line",
        "HUES48_Cell_Line",
        "H1_Cell_Line",
        "H9_Cell_Line",
        "4star",
        "ES_WA7_Cell_Line",
    },
    "ES_derived": {
        "hESC_Derived_CD184pp_Endoderm_Cultured_Cells",
        "H1_Derived_Neuronal_Progenitor_Cultured_Cells",
        "H1_Derived_Mesenchymal_Stem_Cells",
        "hESC_Derived_CD56pp_Ectoderm_Cultured_Cells",
        "H9_Derived_Neuronal_Progenitor_Cultured_Cells",
        "hESC_Derived_CD56pp_Mesoderm_Cultured_Cells",
        "H9_Derived_Neuron_Cultured_Cells",
        "H1_BMP4_Derived_Mesendoderm_Cultured_Cells",
    },
    "HSC_B_cell": {
        "CD34_Cultured_Cells",
        "CD34_Primary_Cells",
        "GM12878_Lymphoblastoid",
        "Mobilized_CD34_Primary_Cells_Female",
        "CD19_Primary_Cells_Peripheral_UW",
        "Mobilized_CD34_Primary_Cells_Male",
        "CD19_Primary_Cells_Cord_BI",
    },
    "Blood_T_cell_Myeloid": {
        "Monocytes_CD14pp_RO01746",
        "CD4pp_CD25__IL17__PMA_Ionomycin_stimulated_MACS_purified_Th_Primary_Cells",
        "CD4pp_CD25pp_CD127__Treg_Primary_Cells",
        "CD4_Naive_Primary_Cells",
        "Spleen",
        "CD56_Primary_Cells",
        "CD3_Primary_Cells_Peripheral_UW",
        "CD4pp_CD25__CD45RApp_Naive_Primary_Cells",
        "CD3_Primary_Cells_Cord_BI",
        "CD4pp_CD25int_CD127pp_Tmem_Primary_Cells",
        "CD14_Primary_Cells",
        "CD4pp_CD25__IL17pp_PMA_Ionomcyin_stimulated_Th17_Primary_Cells",
        "CD15_Primary_Cells",
        "CD8_Memory_Primary_Cells",
        "CD4pp_CD25__CD45ROpp_Memory_Primary_Cells",
        "CD4_Memory_Primary_Cells",
        "Peripheral_Blood_Mononuclear_Primary_Cells",
        "CD4pp_CD25__Th_Primary_Cells",
        "CD8_Naive_Primary_Cells",
    },
    "Cancer_Cell_Line": {
        "Dnd41_TCell_Leukemia",
        "HepG2_Hepatocellular_Carcinoma",
        "HeLa_S3_Cervical_Carcinoma",
        "A549_EtOH_0.02pct_Lung_Carcinoma",
        "K562_Leukemia",
    },
    "Brain": {
        "Fetal_Brain_Male",
        "Brain_Mid_Frontal_Lobe",
        "NH_A_Astrocytes",
        "Brain_Cingulate_Gyrus",
        "Brain_Anterior_Caudate",
        "Brain_Germinal_Matrix",
        "Brain_Substantia_Nigra",
        "Brain_Inferior_Temporal_Lobe",
        "Brain_Hippocampus_Middle",
        "Brain_Angular_Gyrus",
        "Fetal_Brain_Female",
    },
    "Neurosphere": {
        "Neurosphere_Cultured_Cells_Ganglionic_Eminence_Derived",
        "Neurosphere_Cultured_Cells_Cortex_Derived",
    },
    "Digestive": {
        "Adult_Liver",
        "Fetal_Intestine_Small",
        "Stomach_Mucosa",
        "Colonic_Mucosa",
        "Pancreas",
        "Esophagus",
        "Duodenum_Mucosa",
        "Rectal_Mucosa.Donor_31",
        "Sigmoid_Colon",
        "Fetal_Intestine_Large",
        "Fetal_Stomach",
        "Gastric",
        "Small_Intestine",
        "Rectal_Mucosa.Donor_29",
    },
    "Epithelial": {
        "HMEC_Mammary_Epithelial",
        "Breast_vHMEC",
        "Breast_Myoepithelial_Cells",
    },
    "Muscle_Skeletal": {
        "HSMMtube_Skeletal_Muscle_Myotubes_Derived_from_HSMM",
        "Skeletal_Muscle_Female",
        "Muscle_Satellite_Cultured_Cells",
        "Fetal_Muscle_Trunk",
        "Skeletal_Muscle_Male",
        "Fetal_Muscle_Leg",
        "HSMM_Skeletal_Muscle_Myoblasts",
        "Psoas_Muscle",
    },
    "Muscle_Smooth": {
        "Colon_Smooth_Muscle",
        "Rectal_Smooth_Muscle",
        "Stomach_Smooth_Muscle",
        "Duodenum_Smooth_Muscle",
    },
    "Mesenchymal": {
        "Adipose_Nuclei",
        "Chondrocytes_from_Bone_Marrow_Derived_Mesenchymal_Stem_Cell_Cultured_Cells",
        "Osteoblasts",
        "Mesenchymal_Stem_Cell_Derived_Adipocyte_Cultured_Cells",
        "Bone_Marrow_Derived_Mesenchymal_Stem_Cell_Cultured_Cells",
        "Adipose_Derived_Mesenchymal_Stem_Cell_Cultured_Cells",
    },
    "Lung": {"IMR90_Cell_Line", "NHLF_Lung_Fibroblasts", "Fetal_Lung", "Lung"},
    "Heart_Vasculature": {
        "Aorta",
        "HUVEC_Umbilical_Vein_Endothelial_Cells",
        "Right_Ventricle",
        "Right_Atrium",
        "Left_Ventricle",
        "Fetal_Heart",
    },
    "Thymus": {"Thymus", "Fetal_Thymus"},
    "Skin_Cells": {
        "NHEK_Epidermal_Keratinocytes",
        "NHDF_Ad_Adult_Dermal_Fibroblasts",
        "Penis_Foreskin_Fibroblast_Primary_Cells_skin02",
        "Penis_Foreskin_Keratinocyte_Primary_Cells_skin03",
        "Penis_Foreskin_Fibroblast_Primary_Cells_skin01",
        "Penis_Foreskin_Melanocyte_Primary_Cells_skin01",
        "Penis_Foreskin_Melanocyte_Primary_Cells_skin03",
        "Penis_Foreskin_Keratinocyte_Primary_Cells_skin02",
    },
    "Kidney": {"Fetal_Kidney"},
    "Reproductive": {"Ovary"},
    "Endocrine": {"Fetal_Adrenal_Gland", "Pancreatic_Islets"},
    "Placenta": {
        "H1_BMP4_Derived_Trophoblast_Cultured_Cells",
        "Fetal_Placenta",
        "Placenta_Amnion",
    },
}

bed_sizes = [
    18704,
    40382,
    36214,
    82939,
    97029,
    11769,
    6162,
    49620,
    484,
    1685,
    4964,
    13043,
    39587,
    1030,
    94089,
    15559,
    15964,
    33873,
    117954,
    104452,
    16509,
    24385,
    53722,
    2629,
    6443,
    7712,
    8415,
    16641,
    1570,
    95596,
    17828,
    42983,
    33582,
    83701,
    109696,
    14687,
    3580,
    43784,
    4583,
    5059,
    6028,
    23434,
    39478,
    4382,
    93308,
    20173,
    29699,
    30782,
    91975,
    102261,
    8144,
    3104,
    18755,
    2447,
    823,
    3840,
    36391,
    60784,
    1241,
    65177,
    15832,
    54454,
    33638,
    67590,
    91109,
    10864,
    5427,
    41310,
    3274,
    9405,
    11466,
    27996,
    37282,
    2801,
    76256,
    21222,
    35034,
    29219,
    91438,
    110878,
    10430,
    2683,
    18151,
    2324,
    1604,
    4115,
    21915,
    40994,
    1776,
    67186,
    21172,
    42931,
    39382,
    97130,
    110257,
    12807,
    5874,
    46961,
    2577,
    7586,
    11403,
    22532,
    42059,
    1365,
    91575,
    20446,
    17603,
    25163,
    76038,
    70941,
    3541,
    6264,
    9411,
    4073,
    2599,
    5508,
    16044,
    26473,
    823,
    55682,
    17224,
    21900,
    51678,
    101789,
    77351,
    19107,
    14792,
    55334,
    5517,
    7228,
    9467,
    18739,
    29884,
    4075,
    87644,
    18194,
    32882,
    27822,
    81991,
    107957,
    8995,
    2508,
    38018,
    1246,
    3419,
    4558,
    9420,
    25383,
    1706,
    96598,
    14266,
    18442,
    7024,
    67577,
    97123,
    2824,
    1555,
    4334,
    2092,
    3767,
    11661,
    16840,
    28098,
    296,
    52218,
    24589,
    24759,
    39161,
    103480,
    108155,
    9469,
    22071,
    59112,
    6815,
    4453,
    10016,
    25045,
    37084,
    4117,
    107847,
    16157,
    22227,
    14071,
    67776,
    89458,
    1571,
    5043,
    17343,
    2301,
    4382,
    14730,
    25343,
    36664,
    333,
    66718,
    17812,
    9378,
    16286,
    80494,
    84614,
    2373,
    11139,
    28643,
    2368,
    1757,
    2977,
    3956,
    9153,
    415,
    80760,
    27541,
    33486,
    38209,
    86893,
    75342,
    23338,
    2148,
    54745,
    10063,
    12942,
    23398,
    45923,
    50760,
    13496,
    86508,
    24203,
    24974,
    23135,
    55451,
    45913,
    4879,
    2284,
    13053,
    5172,
    6914,
    6012,
    9382,
    18058,
    1331,
    46582,
    15075,
    17060,
    46450,
    121395,
    112593,
    13031,
    4075,
    31454,
    1826,
    1025,
    5561,
    17381,
    35690,
    755,
    79399,
    23586,
    45058,
    32414,
    91794,
    103050,
    13156,
    2562,
    17667,
    4605,
    8152,
    12146,
    22666,
    35650,
    2283,
    58138,
    21084,
    27606,
    31370,
    97688,
    123086,
    7852,
    10891,
    62690,
    11618,
    13830,
    14640,
    23578,
    31214,
    2858,
    120418,
    23355,
    49299,
    37436,
    97843,
    127323,
    14559,
    3853,
    43310,
    3611,
    4485,
    6519,
    38610,
    58989,
    2407,
    96147,
    19052,
    47703,
    32260,
    88341,
    120236,
    12395,
    2412,
    27194,
    3148,
    4101,
    6474,
    33084,
    51095,
    2940,
    77737,
    26005,
    27346,
    26996,
    79628,
    73854,
    8886,
    2577,
    21580,
    3863,
    2895,
    3755,
    8284,
    21747,
    1104,
    62634,
    22315,
    22062,
    18204,
    95861,
    129057,
    3638,
    7010,
    38975,
    10664,
    6123,
    11997,
    19581,
    26069,
    1204,
    103955,
    17833,
    24894,
    26806,
    82173,
    114525,
    4122,
    4788,
    35776,
    11762,
    13809,
    15586,
    21844,
    24422,
    1688,
    99765,
    24093,
    34320,
    42443,
    92030,
    105654,
    19208,
    4395,
    46773,
    6682,
    7814,
    10007,
    24835,
    41827,
    4514,
    96117,
    20671,
    39429,
    27712,
    77400,
    100048,
    7537,
    2585,
    20038,
    3212,
    4029,
    5603,
    19542,
    35032,
    1583,
    70495,
    18496,
    22518,
    27337,
    107700,
    101910,
    13150,
    9451,
    46434,
    36,
    163,
    149,
    214,
    3808,
    671,
    88655,
    18975,
    19674,
    29760,
    86332,
    108783,
    5554,
    8111,
    46257,
    11522,
    9454,
    11470,
    20561,
    23059,
    2315,
    106152,
    16498,
    18627,
    39092,
    116276,
    98735,
    29467,
    10545,
    45809,
    1901,
    4981,
    14156,
    24113,
    41010,
    2293,
    80950,
    22083,
    30375,
    46252,
    106336,
    104420,
    17622,
    10118,
    56451,
    3113,
    4362,
    8947,
    33429,
    48736,
    2278,
    96239,
    16433,
    39912,
    29123,
    61776,
    74639,
    14039,
    3467,
    18374,
    1572,
    5847,
    10236,
    17141,
    32260,
    3520,
    56772,
    14365,
    12329,
    24078,
    73809,
    85214,
    2029,
    3394,
    17836,
    9493,
    8585,
    12595,
    19081,
    23013,
    550,
    69391,
    18626,
    15215,
    26648,
    84167,
    71586,
    10464,
    7671,
    44607,
    1903,
    2867,
    4850,
    5881,
    19004,
    1024,
    84957,
    22501,
    30803,
    28739,
    80024,
    104446,
    5716,
    7157,
    43888,
    13020,
    12169,
    12986,
    22453,
    26670,
    2897,
    100008,
    28072,
    42422,
    36689,
    84158,
    83375,
    10871,
    4546,
    35431,
    4859,
    6367,
    6802,
    12969,
    27268,
    2244,
    74747,
    22917,
    37013,
    33142,
    78265,
    79535,
    7364,
    2694,
    20135,
    3543,
    3937,
    4846,
    10504,
    22614,
    1213,
    60954,
    18210,
    21495,
    37167,
    74143,
    77844,
    7971,
    14806,
    31049,
    3779,
    4375,
    9764,
    24089,
    38808,
    3606,
    77722,
    22927,
    15543,
    36343,
    105612,
    87203,
    6878,
    5218,
    15332,
    948,
    965,
    1943,
    6623,
    24327,
    296,
    63519,
    17999,
    23915,
    43746,
    112220,
    104614,
    24834,
    6963,
    66529,
    3589,
    5177,
    14802,
    49238,
    66445,
    2796,
    99217,
    11062,
    29367,
    33193,
    53509,
    54640,
    12313,
    6846,
    32841,
    548,
    2145,
    3074,
    14911,
    33233,
    6317,
    69223,
    21739,
    5236,
    31444,
    90452,
    51667,
    4119,
    12240,
    74461,
    917,
    328,
    652,
    4308,
    23744,
    357,
    108319,
    22910,
    47085,
    34060,
    90402,
    114695,
    13242,
    1884,
    24965,
    3971,
    3372,
    4960,
    31343,
    50430,
    2529,
    72104,
    21037,
    22003,
    17478,
    77490,
    113210,
    2806,
    3373,
    27074,
    13209,
    12980,
    15605,
    24402,
    30362,
    1340,
    90733,
    15853,
    36681,
    39522,
    80684,
    88163,
    15675,
    9511,
    30150,
    1243,
    5635,
    9603,
    17718,
    31733,
    3772,
    69161,
    21283,
    19419,
    12224,
    114429,
    110159,
    21317,
    24408,
    36406,
    3063,
    8785,
    9945,
    6976,
    14096,
    6757,
    75676,
    18579,
    33973,
    29150,
    53819,
    52052,
    10379,
    3196,
    29819,
    3169,
    6758,
    7860,
    16952,
    30031,
    4122,
    61553,
    14786,
    24202,
    43107,
    89736,
    99698,
    19422,
    5114,
    41155,
    4498,
    11727,
    28533,
    59666,
    77727,
    1499,
    82848,
    15901,
    37932,
    25981,
    66841,
    89464,
    8684,
    1887,
    49506,
    1937,
    4017,
    5763,
    29185,
    45035,
    1399,
    96060,
    16607,
    17663,
    42361,
    77834,
    66332,
    15951,
    4607,
    29604,
    4713,
    13867,
    45333,
    41520,
    57541,
    1659,
    61015,
    21289,
    31636,
    25779,
    83296,
    96300,
    6820,
    2565,
    13065,
    3587,
    2845,
    3664,
    8133,
    15102,
    1004,
    59021,
    16964,
    34756,
    21552,
    57599,
    71030,
    6524,
    2446,
    6785,
    829,
    2102,
    4254,
    4551,
    14319,
    1090,
    42621,
    19015,
    25920,
    28969,
    86168,
    118298,
    5655,
    6220,
    38582,
    10273,
    10684,
    13078,
    19073,
    23378,
    2187,
    101535,
    15968,
    13702,
    31172,
    95346,
    86316,
    16531,
    7743,
    38544,
    500,
    1692,
    4110,
    2552,
    6815,
    1306,
    72932,
    19982,
    45091,
    32537,
    83858,
    110222,
    14990,
    2285,
    31242,
    13205,
    15835,
    23141,
    44065,
    61224,
    2513,
    67756,
    14207,
    25842,
    32514,
    64898,
    68549,
    11999,
    3123,
    48886,
    730,
    4173,
    11548,
    15850,
    30908,
    1053,
    86034,
    14443,
    27312,
    32546,
    60822,
    60069,
    14559,
    2828,
    21276,
    1643,
    9009,
    23658,
    52573,
    71659,
    1670,
    49330,
    19519,
    38777,
    28321,
    62092,
    70671,
    9420,
    3395,
    16183,
    1752,
    4461,
    6446,
    8956,
    20686,
    6848,
    52311,
    17202,
    34857,
    40024,
    84874,
    78122,
    5919,
    9983,
    34126,
    1963,
    4650,
    7231,
    18711,
    31380,
    559,
    71393,
    14908,
    9186,
    36090,
    91071,
    71090,
    9355,
    4072,
    30778,
    1905,
    1588,
    6672,
    11566,
    35447,
    478,
    69214,
    20489,
    41604,
    26316,
    66468,
    84655,
    7896,
    1824,
    9169,
    599,
    399,
    835,
    18940,
    31841,
    3101,
    56561,
    24859,
    37658,
    36014,
    85654,
    92180,
    7521,
    8573,
    40649,
    3059,
    4687,
    5925,
    14221,
    28694,
    1536,
    84913,
    28531,
    57319,
    37359,
    105986,
    143268,
    13715,
    5653,
    49012,
    2966,
    1984,
    4995,
    33821,
    61557,
    2457,
    100046,
    17088,
    21473,
    41280,
    86333,
    78363,
    11246,
    7795,
    34713,
    5622,
    6526,
    9275,
    23566,
    34913,
    1469,
    73897,
    25128,
    34249,
    28107,
    86209,
    92195,
    8970,
    2833,
    23224,
    4545,
    3911,
    4879,
    12043,
    27213,
    961,
    70039,
    25248,
    42733,
    43094,
    97991,
    101921,
    26234,
    4562,
    65971,
    7264,
    11499,
    22957,
    51986,
    59855,
    9880,
    100188,
    18844,
    35899,
    43854,
    75478,
    61025,
    11464,
    5884,
    24230,
    5440,
    4547,
    4152,
    21891,
    33429,
    2121,
    55955,
    21140,
    21527,
    28038,
    79729,
    71588,
    14248,
    7423,
    27833,
    5096,
    7858,
    16946,
    38962,
    51542,
    3543,
    64346,
    31210,
    38466,
    31960,
    95925,
    98203,
    9997,
    3432,
    35329,
    3197,
    2556,
    2676,
    6150,
    21388,
    1213,
    84299,
    20663,
    44708,
    30184,
    84883,
    101213,
    13517,
    3246,
    16636,
    5646,
    11856,
    19504,
    34362,
    44620,
    4097,
    54615,
    15383,
    18572,
    51614,
    91891,
    71969,
    16006,
    11489,
    38523,
    7197,
    11359,
    24622,
    40678,
    51302,
    2560,
    71560,
    20671,
    29746,
    26965,
    54702,
    48605,
    4733,
    2431,
    10588,
    1921,
    3701,
    5053,
    6555,
    17546,
    869,
    44513,
    21956,
    27663,
    29437,
    78551,
    80522,
    11193,
    2360,
    22937,
    2812,
    1720,
    2893,
    19014,
    33680,
    3133,
    64960,
    12464,
    26747,
    30065,
    66401,
    82140,
    8934,
    5308,
    83569,
    1216,
    5988,
    13338,
    22669,
    31282,
    675,
    120640,
    18163,
    23913,
    34196,
    66581,
    46722,
    8138,
    6513,
    19004,
    7211,
    5881,
    4625,
    15055,
    23755,
    1803,
    48549,
    16509,
    29995,
    37197,
    88514,
    100049,
    9174,
    8286,
    33759,
    2012,
    6233,
    13150,
    28513,
    43051,
    795,
    78659,
    23825,
    21542,
    25594,
    88685,
    81214,
    11605,
    1756,
    24716,
    2073,
    2495,
    3183,
    6996,
    19739,
    1154,
    62758,
    28268,
    15198,
    8913,
    56897,
    63279,
    502,
    4981,
    45045,
    1995,
    124,
    279,
    8544,
    26341,
    214,
    93720,
    17861,
    11190,
    28195,
    89823,
    74180,
    12674,
    5326,
    24338,
    77,
    320,
    271,
    178,
    4346,
    815,
    63264,
    26595,
    58205,
    32347,
    74732,
    94668,
    14563,
    11942,
    33445,
    2046,
    2958,
    4203,
    9432,
    28612,
    8002,
    71748,
    12568,
    39028,
    33518,
    75865,
    99394,
    9909,
    9029,
    43267,
    1213,
    8758,
    14174,
    23961,
    34374,
    1079,
    85471,
    16591,
    36698,
    26882,
    58581,
    69121,
    9443,
    2278,
    15256,
    1160,
    3440,
    7083,
    11878,
    26109,
    9984,
    52727,
    19841,
    26554,
    41922,
    97574,
    106242,
    17657,
    6235,
    42159,
    4732,
    7234,
    10005,
    31552,
    48890,
    2171,
    92105,
    16075,
    22749,
    32741,
    82290,
    91794,
    11881,
    3778,
    58763,
    1563,
    5871,
    17991,
    19978,
    36465,
    877,
    97359,
    13519,
    22279,
    32218,
    68749,
    69688,
    12519,
    4919,
    32172,
    3426,
    7607,
    13021,
    17291,
    20513,
    1935,
    67751,
    17195,
    15263,
    26327,
    84605,
    98825,
    4494,
    7498,
    35810,
    9131,
    12555,
    15750,
    17145,
    23462,
    1137,
    88654,
    11667,
    35247,
    25416,
    54017,
    71080,
    7816,
    2753,
    42838,
    1929,
    6122,
    9046,
    19838,
    31652,
    1518,
    76228,
    30899,
    16538,
    1242,
    82861,
    96548,
    2313,
    2479,
    27112,
    493,
    200,
    321,
    2524,
    19743,
    5757,
    80944,
    16468,
    31836,
    17984,
    54720,
    68119,
    5501,
    2228,
    7689,
    985,
    1953,
    4477,
    5664,
    16877,
    913,
    43162,
    17038,
    10520,
    42115,
    86230,
    82385,
    12972,
    9675,
    50543,
    4428,
    1870,
    3108,
    8217,
    18784,
    2977,
    97155,
    17746,
    28843,
    38742,
    106348,
    112162,
    8112,
    8017,
    23099,
    3367,
    5269,
    12895,
    27855,
    37854,
    1561,
    73872,
    24201,
    46485,
    36009,
    91729,
    114483,
    11174,
    3016,
    30104,
    3181,
    1925,
    2714,
    30571,
    49144,
    2564,
    83140,
    23303,
    28710,
    29590,
    70379,
    75405,
    5643,
    5465,
    31134,
    10599,
    9652,
    8205,
    15801,
    26944,
    1547,
    74797,
    13675,
    4529,
    13143,
    62008,
    62517,
    1359,
    1870,
    9849,
    1984,
    505,
    4115,
    14938,
    36734,
    88,
    51888,
    20901,
    7703,
    23519,
    79886,
    76740,
    2420,
    7419,
    30344,
    5734,
    1944,
    3525,
    8454,
    14160,
    948,
    80965,
    18388,
    17049,
    33353,
    110755,
    119179,
    8163,
    14195,
    42335,
    3612,
    7107,
    10412,
    16018,
    36168,
    680,
    89774,
    24312,
    31383,
    25346,
    86913,
    96487,
    7426,
    3256,
    26215,
    2430,
    2113,
    3209,
    6979,
    20344,
    785,
    74363,
    17532,
    6905,
    16110,
    72132,
    75049,
    2737,
    3912,
    16012,
    5142,
    3900,
    6416,
    9447,
    14132,
    472,
    65857,
    28092,
    35332,
    31389,
    90266,
    89583,
    10692,
    3445,
    29044,
    4008,
    3509,
    3733,
    9144,
    24755,
    1220,
    75376,
    14556,
    31782,
    17793,
    52646,
    69593,
    5421,
    2665,
    15044,
    489,
    2243,
    6842,
    9805,
    24201,
    709,
    53895,
    15295,
    32587,
    17324,
    53902,
    74210,
    5936,
    1919,
    11154,
    531,
    1720,
    4144,
    4249,
    15286,
    625,
    48381,
    12683,
    27742,
    33685,
    65071,
    72842,
    12800,
    5097,
    34836,
    787,
    4781,
    12381,
    13876,
    29187,
    1135,
    70083,
    16250,
    23355,
    37298,
    65340,
    42720,
    10021,
    2907,
    24759,
    4416,
    5471,
    6045,
    16310,
    30557,
    1042,
    57296,
    28456,
    30304,
    25792,
    72816,
    70041,
    4698,
    2367,
    11602,
    4912,
    2485,
    1631,
    7172,
    17638,
    1315,
    54557,
    19134,
    15870,
    39120,
    119515,
    98382,
    16622,
    4477,
    37584,
    2231,
    2654,
    5361,
    13783,
    35220,
    809,
    79794,
    25384,
    46455,
    32695,
    85206,
    95998,
    15612,
    6351,
    19160,
    3262,
    2073,
    2284,
    25344,
    40473,
    5504,
    65218,
    19122,
    2309,
    3404,
    43602,
    61401,
    92,
    1563,
    15243,
    7053,
    1266,
    7851,
    18430,
    31704,
    5,
    68793,
    15180,
    13064,
    22533,
    65906,
    68605,
    3314,
    815,
    5245,
    972,
    2404,
    6013,
    8364,
    12988,
    250,
    46828,
    26064,
    51403,
    40415,
    109609,
    146159,
    17366,
    5431,
    37568,
    4947,
    3446,
    9309,
    38436,
    59019,
    3165,
    87172,
    34433,
    38438,
    35716,
    73075,
    59208,
    7692,
    2767,
    16602,
    4849,
    4681,
    5301,
    11881,
    25167,
    2584,
    53944,
    26792,
    39795,
    31495,
    94297,
    104168,
    10454,
    4064,
    32674,
    5252,
    6009,
    6371,
    11914,
    27481,
    1244,
    80092,
    31913,
    48081,
    38764,
    80914,
    73503,
    12658,
    3037,
    28646,
    6945,
    8597,
    11767,
    37610,
    55409,
    4097,
    62981,
    14864,
    34078,
    29507,
    58465,
    65487,
    11927,
    3428,
    23748,
    1244,
    5275,
    9001,
    14440,
    29258,
    1079,
    59523,
    16244,
    55186,
    40030,
    84352,
    111703,
    12855,
    14451,
    60297,
    2137,
    10084,
    14303,
    33884,
    44181,
    2478,
    98853,
    15597,
    29548,
    19036,
    56891,
    70318,
    5160,
    2716,
    12053,
    988,
    2296,
    5972,
    9163,
    23446,
    419,
    51580,
    20556,
    40191,
    28029,
    80588,
    92363,
    15266,
    3818,
    12333,
    757,
    1033,
    4061,
    14763,
    33034,
    6131,
    49615,
    14648,
    30479,
    8309,
    86439,
    129946,
    4395,
    3504,
    6976,
    629,
    1497,
    6988,
    13725,
    25065,
    456,
    61916,
    18094,
    29122,
    39165,
    84464,
    97181,
    9231,
    14449,
    21164,
    2634,
    4788,
    10611,
    26412,
    45388,
    2514,
    77928,
    15297,
    35375,
    41794,
    73325,
    64599,
    9440,
    7182,
    19933,
    1992,
    3841,
    6484,
    17462,
    34833,
    1727,
    51169,
    15653,
    23238,
    44380,
    97741,
    99837,
    19694,
    8289,
    45254,
    4697,
    11568,
    28202,
    35420,
    51971,
    2270,
    82075,
    25733,
    28021,
    26235,
    85506,
    84027,
    7683,
    2602,
    19071,
    2697,
    1692,
    2297,
    6838,
    20118,
    645,
    64756,
    25017,
    27530,
    31993,
    73026,
    65299,
    5840,
    6098,
    40279,
    8275,
    6475,
    5706,
    20232,
    29287,
    1778,
    79277,
    16237,
    13176,
    35213,
    99207,
    77387,
    13841,
    14008,
    78362,
    627,
    1276,
    4063,
    5761,
    20884,
    738,
    110181,
    25730,
    27170,
    35952,
    85185,
    71361,
    7169,
    5744,
    34799,
    6520,
    6388,
    6375,
    14768,
    23829,
    1642,
    72204,
    20896,
    28218,
    40138,
    90991,
    89678,
    14743,
    4192,
    19440,
    3172,
    1245,
    1924,
    15331,
    33106,
    3261,
    66902,
    25848,
    34304,
    41492,
    92357,
    102038,
    17099,
    3107,
    29742,
    10477,
    8156,
    9585,
    29349,
    45151,
    4714,
    78887,
    21227,
    14105,
    13853,
    83898,
    83371,
    3030,
    2734,
    41234,
    4178,
    3207,
    2248,
    5868,
    19832,
    469,
    84600,
    15431,
    5528,
    642,
    56143,
    81870,
    312,
    2789,
    24129,
    4682,
    956,
    3875,
    10749,
    17592,
    86,
    82021,
]

# INFO: deterministic order
bed_names = [f"{x}_{y}" for x in cell_types for y in chromatin_states]

_cell_category_inverse = {
    value: category for (category, values) in cell_category.items() for value in values
}


@cache
def chro_state_id(label: str) -> int:
    return chromatin_states.index(label)


@cache
def cell_type_id(label: str) -> int:
    return cell_types.index(label)


@cache
def bed_id(label: str) -> int:
    return bed_names.index(label)


def category_of(cell_type: str):
    return _cell_category_inverse[cell_type]


def cell_type_chrm_state_split(name: str) -> tuple[str, str]:
    name = name.strip()
    states = list()

    for chrm_state in chromatin_states:
        if name.endswith(chrm_state):
            states.append(chrm_state)

    if len(states) == 0:
        raise ValueError(f"{name} didn't match a known chromatin state")

    chrm_state = sorted(states, key=len)[-1]
    cell_type = name[: -len(chrm_state) - 1]
    return cell_type, chrm_state
